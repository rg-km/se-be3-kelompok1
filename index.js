const CELL_SIZE=17,CANVAS_SIZE=510,REDRAW_INTERVAL=50,WIDTH=30,HEIGHT=30,DIRECTION={LEFT:0,RIGHT:1,UP:2,DOWN:3};var MOVE_INTERVAL=120,RESET_INTERVAL=120,wallX=[],wallY=[],wall2=[{x1:4,x2:25,y:7}],wall3=[{x1:4,x2:25,y:14}],wall4=[{x1:4,x2:25,y:21}],wall5=[{x:6,y1:4,y2:18},{x:23,y1:11,y2:25}];function initPosition(){return{x:Math.floor(30*Math.random()),y:Math.floor(30*Math.random())}}function initHeadAndBody(){let e=initPosition();return{head:e,body:[{x:e.x,y:e.y}]}}function initDirection(){return Math.floor(4*Math.random())}function initSnake(e){return{color:e,...initHeadAndBody(),direction:initDirection(),score:0,scoreReset:0,level:1,life:3}}let snake=initSnake("green"),apple1={position:initPosition()},apple2={position:initPosition()},lifes={position:initPosition()};function checkPrime(e){let l=0;for(let t=1;t<=e;t++)e%t==0&&l++;return 2==l}function drawCell(e,l,t,n){e.fillStyle=n,e.fillRect(17*l,17*t,17,17)}function drawScore(e){let l;e.color==e.color&&(l=document.getElementById("scoreBoard"));let t=l.getContext("2d");t.clearRect(0,0,510,510),t.font="25px Arial",t.fillStyle=e.color,t.fillText(e.score,10,l.scrollHeight/1.5)}function initWall2(){for(let e=0;e<wall2.length;e++)for(let l=wall2[e].x1;l<=wall2[e].x2;l++)wallX.push(l),wallY.push(wall2[e].y)}function initWall3(){for(let e=0;e<wall3.length;e++)for(let l=wall3[e].x1;l<=wall3[e].x2;l++)wallX.push(l),wallY.push(wall3[e].y)}function initWall4(){for(let e=0;e<wall4.length;e++)for(let l=wall4[e].x1;l<=wall4[e].x2;l++)wallX.push(l),wallY.push(wall4[e].y)}function initWall5(){for(let e=0;e<wall5.length;e++)for(let l=wall5[e].y1;l<=wall5[e].y2;l++)wallY.push(l),wallX.push(wall5[e].x)}function createWall(){let e=document.getElementById("snakeBoard").getContext("2d");for(let l=0;l<wallX.length;l++){let t=document.getElementById("trap");e.drawImage(t,17*wallX[l],17*wallY[l],17,17)}}function draw(){setInterval((function(){let e=document.getElementById("snakeBoard").getContext("2d");if(e.clearRect(0,0,510,510),0==snake.direction){let l=document.getElementById("snake-head-left");e.drawImage(l,17*snake.head.x,17*snake.head.y,17,17)}else if(1==snake.direction){let l=document.getElementById("snake-head-right");e.drawImage(l,17*snake.head.x,17*snake.head.y,17,17)}else if(2==snake.direction){let l=document.getElementById("snake-head-up");e.drawImage(l,17*snake.head.x,17*snake.head.y,17,17)}else if(3==snake.direction){let l=document.getElementById("snake-head-down");e.drawImage(l,17*snake.head.x,17*snake.head.y,17,17)}let l=document.getElementById("snake-body");for(let t=1;t<snake.body.length;t++)e.drawImage(l,17*snake.body[t].x,17*snake.body[t].y,17,17);let t=document.getElementById("apple");if(e.drawImage(t,17*apple1.position.x,17*apple1.position.y,17,17),e.drawImage(t,17*apple2.position.x,17*apple2.position.y,17,17),checkPrime(snake.score)){let l=document.getElementById("eatable-life");e.drawImage(l,17*lifes.position.x,17*lifes.position.y,17,17)}let n=document.getElementById("life-icon");var a=0;for(let l=1;l<=snake.life;l++)e.drawImage(n,17*a,0,17,17),a+=1;createWall(),document.getElementById("level").innerHTML="Snake Game - Level: "+snake.level,document.getElementById("score").innerHTML="Score",drawScore(snake),document.getElementById("speed").innerHTML="Speed "+MOVE_INTERVAL+" ms"}),50)}function teleport(e){e.head.x<0&&(e.head.x=29),e.head.x>=30&&(e.head.x=0),e.head.y<0&&(e.head.y=29),e.head.y>=30&&(e.head.y=0)}function eat(e,l,t,n){var a=document.getElementById("eat-apple");e.head.x==l.position.x&&e.head.y==l.position.y&&(a.play(),l.position=initPosition(),e.score++,e.scoreReset++,e.body.push({x:e.head.x,y:e.head.y})),e.head.x==t.position.x&&e.head.y==t.position.y&&(a.play(),t.position=initPosition(),e.score++,e.scoreReset++,e.body.push({x:e.head.x,y:e.head.y})),e.head.x==n.position.x&&e.head.y==n.position.y&&checkPrime(e.score)&&(a.play(),n.position=initPosition(),e.score++,e.scoreReset++,e.life++,e.body.push({x:e.head.x,y:e.head.y}));for(a=document.getElementById("level-up");5===e.scoreReset;)e.level<=4&&(1==e.level?initWall2():2==e.level?initWall3():3==e.level?initWall4():4==e.level&&(wallX=[],wallY=[],initWall5()),a.play(),e.level++,MOVE_INTERVAL-=15,alert("Level Up - Level: "+e.level)),e.scoreReset=0}function moveLeft(e){e.head.x--,teleport(e),eat(e,apple1,apple2,lifes)}function moveRight(e){e.head.x++,teleport(e),eat(e,apple1,apple2,lifes)}function moveDown(e){e.head.y++,teleport(e),eat(e,apple1,apple2,lifes)}function moveUp(e){e.head.y--,teleport(e),eat(e,apple1,apple2,lifes)}function moveStop(e){e.direction=DIRECTION.STOP}function checkCollision(e){let l=!1;var t=document.getElementById("hit-something");for(let n=0;n<e.length;n++)for(let a=0;a<e.length;a++)for(let o=1;o<e[a].body.length;o++)e[n].head.x==e[a].body[o].x&&e[n].head.y==e[a].body[o].y&&(t.play(),snake.life--,0==snake.life&&(l=!0));for(let e=0;e<wallX.length;e++)snake.head.x!==wallX[e]||2!=snake.direction&&3!=snake.direction||snake.head.y!==wallY[e]&&snake.head.y!==wallY[e]||(t.play(),snake.life--,0==snake.life&&(l=!0)),snake.head.y!==wallY[e]||0!=snake.direction&&1!=snake.direction||snake.head.x!==wallX[e]&&snake.head.x!==wallX[e]||(t.play(),snake.life--,0==snake.life&&(l=!0));for(let e=0;e<wallX.length;e++)apple1.position.x===wallX[e]&&(apple1.position.y!==wallY[e]&&apple1.position.y!==wallY[e]||(apple1.position=initPosition())),apple2.position.y===wallY[e]&&(apple2.position.x!==wallX[e]&&apple2.position.x!==wallX[e]||(apple2.position=initPosition()));for(let e=0;e<wallX.length;e++)lifes.position.x===wallX[e]&&(lifes.position.y!==wallY[e]&&lifes.position.y!==wallY[e]||(lifes.position=initPosition())),apple2.position.y===wallY[e]&&(apple2.position.x!==wallX[e]&&apple2.position.x!==wallX[e]||(apple2.position=initPosition()));t=document.getElementById("game-over");return l&&(t.play(),alert("Game over - You get score "+snake.score),MOVE_INTERVAL=RESET_INTERVAL,wallX=[],wallY=[],snake=initSnake("green")),l}function move(e){switch(e.direction){case DIRECTION.LEFT:moveLeft(e);break;case DIRECTION.RIGHT:moveRight(e);break;case DIRECTION.DOWN:moveDown(e);break;case DIRECTION.UP:moveUp(e)}moveBody(e),checkCollision([e])?initGame():setTimeout((function(){move(e)}),MOVE_INTERVAL)}function moveBody(e){e.body.unshift({x:e.head.x,y:e.head.y}),e.body.pop()}function turn(e,l){l!=={[DIRECTION.LEFT]:DIRECTION.RIGHT,[DIRECTION.RIGHT]:DIRECTION.LEFT,[DIRECTION.DOWN]:DIRECTION.UP,[DIRECTION.UP]:DIRECTION.DOWN}[e.direction]&&(e.direction=l)}function initGame(){move(snake)}document.addEventListener("keydown",(function(e){"ArrowLeft"===e.key?turn(snake,DIRECTION.LEFT):"ArrowRight"===e.key?turn(snake,DIRECTION.RIGHT):"ArrowUp"===e.key?turn(snake,DIRECTION.UP):"ArrowDown"===e.key&&turn(snake,DIRECTION.DOWN)})),initGame();
